"use strict";(globalThis.webpackChunkbook_frontend=globalThis.webpackChunkbook_frontend||[]).push([[513],{1117(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"ros2-module/python-agents-rclpy","title":"Chapter 2: Python Agents with rclpy","description":"This chapter focuses on using rclpy, the Python client library for ROS 2, to create agents that can interact with the ROS 2 ecosystem. We\'ll explore how to bridge AI logic to robot controllers using Python.","source":"@site/docs/ros2-module/02-python-agents-rclpy.md","sourceDirName":"ros2-module","slug":"/ros2-module/python-agents-rclpy","permalink":"/first-phase-hackathon/docs/ros2-module/python-agents-rclpy","draft":false,"unlisted":false,"editUrl":"https://github.com/your-username/your-project-name/tree/main/packages/create-docusaurus/templates/shared/docs/ros2-module/02-python-agents-rclpy.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 1: ROS 2 Architecture","permalink":"/first-phase-hackathon/docs/ros2-module/ros2-architecture"},"next":{"title":"Chapter 3: URDF for Humanoids","permalink":"/first-phase-hackathon/docs/ros2-module/urdf-humanoids"}}');var i=r(4848),l=r(8453);const t={sidebar_position:2},o="Chapter 2: Python Agents with rclpy",a={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction to rclpy",id:"introduction-to-rclpy",level:2},{value:"Key Features of rclpy:",id:"key-features-of-rclpy",level:3},{value:"Basic Setup:",id:"basic-setup",level:3},{value:"Creating ROS 2 Nodes Using Python",id:"creating-ros-2-nodes-using-python",level:2},{value:"Basic Node Structure:",id:"basic-node-structure",level:3},{value:"Node Best Practices:",id:"node-best-practices",level:3},{value:"Publishers and Subscribers",id:"publishers-and-subscribers",level:2},{value:"Publisher Example:",id:"publisher-example",level:3},{value:"Subscriber Example:",id:"subscriber-example",level:3},{value:"Bridging AI Logic to Robot Controllers",id:"bridging-ai-logic-to-robot-controllers",level:2},{value:"Example: AI Controller Bridge",id:"example-ai-controller-bridge",level:3},{value:"Advanced rclpy Features",id:"advanced-rclpy-features",level:2},{value:"Using Services",id:"using-services",level:3},{value:"Using Parameters",id:"using-parameters",level:3},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"chapter-2-python-agents-with-rclpy",children:"Chapter 2: Python Agents with rclpy"})}),"\n",(0,i.jsx)(n.p,{children:"This chapter focuses on using rclpy, the Python client library for ROS 2, to create agents that can interact with the ROS 2 ecosystem. We'll explore how to bridge AI logic to robot controllers using Python."}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsx)(n.p,{children:"After completing this chapter, you will be able to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Understand the rclpy Python client library and its purpose"}),"\n",(0,i.jsx)(n.li,{children:"Create ROS 2 nodes using Python"}),"\n",(0,i.jsx)(n.li,{children:"Implement publishers and subscribers with rclpy"}),"\n",(0,i.jsx)(n.li,{children:"Bridge AI logic to robot controllers via rclpy"}),"\n",(0,i.jsx)(n.li,{children:"Use rclpy effectively for robot communication"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"introduction-to-rclpy",children:"Introduction to rclpy"}),"\n",(0,i.jsx)(n.p,{children:"rclpy is the Python client library for ROS 2. It provides a Python API that allows you to write ROS 2 nodes, publish and subscribe to topics, provide and use services, and manage parameters."}),"\n",(0,i.jsx)(n.h3,{id:"key-features-of-rclpy",children:"Key Features of rclpy:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Pythonic interface to ROS 2 concepts"}),"\n",(0,i.jsx)(n.li,{children:"Support for all ROS 2 client library features"}),"\n",(0,i.jsx)(n.li,{children:"Integration with Python's async/await for asynchronous operations"}),"\n",(0,i.jsx)(n.li,{children:"Type support for ROS message definitions"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"basic-setup",children:"Basic Setup:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\n# Initialize the ROS 2 client library\nrclpy.init()\n\n# Create a node\nnode = Node('my_node')\n\n# Your node logic here\n\n# Shutdown when done\nrclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-ros-2-nodes-using-python",children:"Creating ROS 2 Nodes Using Python"}),"\n",(0,i.jsx)(n.p,{children:"Creating a node in rclpy involves subclassing the Node class and implementing the desired functionality."}),"\n",(0,i.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass MyNode(Node):\n    def __init__(self):\n        super().__init__('my_node_name')\n        self.get_logger().info('MyNode has been initialized')\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    my_node = MyNode()\n\n    try:\n        rclpy.spin(my_node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        my_node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"node-best-practices",children:"Node Best Practices:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use meaningful node names"}),"\n",(0,i.jsx)(n.li,{children:"Initialize resources in the constructor"}),"\n",(0,i.jsx)(n.li,{children:"Clean up resources in destroy_node()"}),"\n",(0,i.jsx)(n.li,{children:"Use the logger for output instead of print()"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"publishers-and-subscribers",children:"Publishers and Subscribers"}),"\n",(0,i.jsx)(n.p,{children:"rclpy provides a straightforward way to implement the publish-subscribe pattern for message passing."}),"\n",(0,i.jsx)(n.h3,{id:"publisher-example",children:"Publisher Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"subscriber-example",children:"Subscriber Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_subscriber = MinimalSubscriber()\n    rclpy.spin(minimal_subscriber)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"bridging-ai-logic-to-robot-controllers",children:"Bridging AI Logic to Robot Controllers"}),"\n",(0,i.jsx)(n.p,{children:"One of the key applications of ROS 2 with Python is bridging AI logic to robot controllers. This enables sophisticated decision-making and planning algorithms to control physical robots."}),"\n",(0,i.jsx)(n.h3,{id:"example-ai-controller-bridge",children:"Example: AI Controller Bridge"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom geometry_msgs.msg import Twist\n\nclass AIControllerBridge(Node):\n    def __init__(self):\n        super().__init__('ai_controller_bridge')\n\n        # Publisher to send commands to robot\n        self.cmd_vel_publisher = self.create_publisher(Twist, '/cmd_vel', 10)\n\n        # Subscriber to receive sensor data\n        self.sensor_subscriber = self.create_subscription(\n            String,\n            '/sensor_data',\n            self.sensor_callback,\n            10\n        )\n\n        # Timer for AI decision making\n        self.timer = self.create_timer(0.1, self.ai_decision_loop)\n\n        self.latest_sensor_data = None\n\n    def sensor_callback(self, msg):\n        self.latest_sensor_data = msg.data\n        # Process sensor data for AI logic\n\n    def ai_decision_loop(self):\n        if self.latest_sensor_data:\n            # Implement AI logic here\n            command = self.make_decision(self.latest_sensor_data)\n\n            # Send command to robot\n            cmd_msg = Twist()\n            cmd_msg.linear.x = command['linear']\n            cmd_msg.angular.z = command['angular']\n            self.cmd_vel_publisher.publish(cmd_msg)\n\n    def make_decision(self, sensor_data):\n        # Placeholder for AI decision-making logic\n        # In a real implementation, this could use machine learning models\n        # or other AI algorithms\n        return {'linear': 0.5, 'angular': 0.0}\n\ndef main(args=None):\n    rclpy.init(args=args)\n    ai_bridge = AIControllerBridge()\n    rclpy.spin(ai_bridge)\n    ai_bridge.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"advanced-rclpy-features",children:"Advanced rclpy Features"}),"\n",(0,i.jsx)(n.h3,{id:"using-services",children:"Using Services"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\n\nclass MinimalService(Node):\n    def __init__(self):\n        super().__init__('minimal_service')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\n        return response\n"})}),"\n",(0,i.jsx)(n.h3,{id:"using-parameters",children:"Using Parameters"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('my_parameter', 'default_value')\n\n        # Get parameter value\n        param_value = self.get_parameter('my_parameter').value\n        self.get_logger().info(f'Parameter value: {param_value}')\n"})}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"rclpy provides a powerful and Pythonic way to interact with ROS 2. By creating nodes, publishers, subscribers, and services with rclpy, you can effectively bridge AI logic to robot controllers. The library supports all the essential ROS 2 concepts while maintaining the familiar Python programming patterns."}),"\n",(0,i.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a simple publisher that publishes the current time every second."}),"\n",(0,i.jsx)(n.li,{children:"Implement a subscriber that logs all received messages to a file."}),"\n",(0,i.jsx)(n.li,{children:"Design a node that bridges sensor data from a robot to an AI model for processing."}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>t,x:()=>o});var s=r(6540);const i={},l=s.createContext(i);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);